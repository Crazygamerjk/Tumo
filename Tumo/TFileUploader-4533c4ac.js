import{aj as lt,H as Si,s as je,M as Ti,c as ce,a8 as Ke,a9 as _i,n as ke,N as Re,V as Mi,m as Oi,J as Ni,d as qe,ae as Ii}from"./sentry-24cb811c.js";import{d as we}from"./objects-e4fd392f.js";import{a as De}from"./arrays-f0e989b7.js";let be;const Ri=new Uint8Array(16);function Pi(){if(!be&&(be=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!be))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return be(Ri)}const j=[];for(let e=0;e<256;++e)j.push((e+256).toString(16).slice(1));function Bi(e,i=0){return(j[e[i+0]]+j[e[i+1]]+j[e[i+2]]+j[e[i+3]]+"-"+j[e[i+4]]+j[e[i+5]]+"-"+j[e[i+6]]+j[e[i+7]]+"-"+j[e[i+8]]+j[e[i+9]]+"-"+j[e[i+10]]+j[e[i+11]]+j[e[i+12]]+j[e[i+13]]+j[e[i+14]]+j[e[i+15]]).toLowerCase()}const ki=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ze={randomUUID:ki};function Li(e,i,r){if(Ze.randomUUID&&!i&&!e)return Ze.randomUUID();e=e||{};const h=e.random||(e.rng||Pi)();if(h[6]=h[6]&15|64,h[8]=h[8]&63|128,i){r=r||0;for(let g=0;g<16;++g)i[r+g]=h[g];return i}return Bi(h)}const Q=()=>Li(),zi=e=>{const i={methodName:"get",url:`editor/revision/${e}`};return lt(i)},$i=e=>lt({methodName:"put",url:"/editor/activity",data:e}),vr=e=>lt({methodName:"post",url:"/editor/activity",data:e}),Ui=e=>lt({methodName:"post",url:"editor/revision",data:e}),Hi=({id:e,domains:i})=>{const r={methodName:"put",url:`/editor/revision/${e}/publish`,data:{domains:i}};return lt(r)},gr=(e,i)=>{const r={methodName:"put",url:`/editor/revision/${e}/note`,data:{note:i}};return lt(r)},mr=({activityId:e,activityLanguage:i,limit:r=5,offset:h=0,sort:g=null})=>{let C="/editor/meta?";const P=[`activityId=${e}`,`language=${i}`,`limit=${r}`,`offset=${h}`,`sort=${g}`];return C+=P.join("&"),lt({methodName:"get",url:C})},yr=e=>{const i={methodName:"get",url:`${e}/metadata`};return lt(i)},br=e=>lt({methodName:"post",url:"/list",data:e}),wr=(e,i,r,h)=>lt({methodName:"post",url:"/list/Content",data:{ActivityIds:e,VersionToReturn:i,Language:r,DomainName:h}}),Wi=()=>lt({methodName:"get",url:"/editor/activities/list/"}),Yi=1048576,Gi=1024,Vi=(e,i)=>{let r;switch(i){case Ti:{r=je("VITE_FILE_SERVICE_EXAMINATION_URL");break}case Si:{r=je("VITE_FILE_SERVICE_CREATION_URL");break}}return r+e},Ce=e=>{const i=e.split(".");let r="";return 0<i.length&&(r=i[i.length-1]),r},Pe=e=>({url:"Not uploaded",name:e.name,size:e.size,type:Ce(e.name),fileObject:e}),Dr=e=>{const i=Ce(e);return ce.extensionIcons[i]||ce.unkownExtensionIcon},Xi=e=>ce.supportedImageExtensions.includes(Ce(e)),Be=({file:e,tags:i})=>{const r=new FormData;return r.append("files",e),i&&r.append("tags",JSON.stringify(i)),r},Fi=e=>e/Yi,Cr=e=>e/Gi;var Je={exports:{}};/*!
  * vue-scrollto v2.20.0
  * (c) 2019 Randjelovic Igor
  * @license MIT
  */(function(e,i){(function(r,h){e.exports=h()})(Ke,function(){function r(D){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r=function(v){return typeof v}:r=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},r(D)}function h(){return h=Object.assign||function(D){for(var v=1;v<arguments.length;v++){var w=arguments[v];for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(D[S]=w[S])}return D},h.apply(this,arguments)}var g=4,C=.001,P=1e-7,nt=10,rt=11,gt=1/(rt-1),Ae=typeof Float32Array=="function";function le(D,v){return 1-3*v+3*D}function he(D,v){return 3*v-6*D}function Ut(D){return 3*D}function Ht(D,v,w){return((le(v,w)*D+he(v,w))*D+Ut(v))*D}function Ot(D,v,w){return 3*le(v,w)*D*D+2*he(v,w)*D+Ut(v)}function tt(D,v,w,S,B){var z,k,pt=0;do k=v+(w-v)/2,z=Ht(k,S,B)-D,z>0?w=k:v=k;while(Math.abs(z)>P&&++pt<nt);return k}function Qt(D,v,w,S){for(var B=0;B<g;++B){var z=Ot(v,w,S);if(z===0)return v;var k=Ht(v,w,S)-D;v-=k/z}return v}function te(D){return D}var O=function(v,w,S,B){if(!(0<=v&&v<=1&&0<=S&&S<=1))throw new Error("bezier x values must be in [0, 1] range");if(v===w&&S===B)return te;for(var z=Ae?new Float32Array(rt):new Array(rt),k=0;k<rt;++k)z[k]=Ht(k*gt,v,S);function pt(et){for(var q=0,W=1,xt=rt-1;W!==xt&&z[W]<=et;++W)q+=gt;--W;var At=(et-z[W])/(z[W+1]-z[W]),ut=q+At*gt,Et=Ot(ut,v,S);return Et>=C?Qt(et,ut,v,S):Et===0?ut:tt(et,q,q+gt,v,S)}return function(q){return q===0?0:q===1?1:Ht(pt(q),w,B)}},Wt={ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},ee=!1;try{var pe=Object.defineProperty({},"passive",{get:function(){ee=!0}});window.addEventListener("test",null,pe)}catch{}var ot={$:function(v){return typeof v!="string"?v:document.querySelector(v)},on:function(v,w,S){var B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{passive:!1};w instanceof Array||(w=[w]);for(var z=0;z<w.length;z++)v.addEventListener(w[z],S,ee?B:!1)},off:function(v,w,S){w instanceof Array||(w=[w]);for(var B=0;B<w.length;B++)v.removeEventListener(w[B],S)},cumulativeOffset:function(v){var w=0,S=0;do w+=v.offsetTop||0,S+=v.offsetLeft||0,v=v.offsetParent;while(v);return{top:w,left:S}}},ht=["mousedown","wheel","DOMMouseScroll","mousewheel","keyup","touchmove"],L={container:"body",duration:500,lazy:!0,easing:"ease",offset:0,force:!0,cancelable:!0,onStart:!1,onDone:!1,onCancel:!1,x:!1,y:!0};function mt(D){L=h({},L,D)}var st=function(){var v,w,S,B,z,k,pt,et,q,W,xt,At,ut,Et,Yt,Pt,Bt,Gt,Vt,dt,kt,Xt,ae,de=function(I){et&&(ae=I,dt=!0)},fe,Ft,jt,St;function ve(V){var I=V.scrollTop;return V.tagName.toLowerCase()==="body"&&(I=I||document.documentElement.scrollTop),I}function Ee(V){var I=V.scrollLeft;return V.tagName.toLowerCase()==="body"&&(I=I||document.documentElement.scrollLeft),I}function ge(){kt=ot.cumulativeOffset(w),Xt=ot.cumulativeOffset(v),At&&(Yt=Xt.left-kt.left+k,Gt=Yt-Et),ut&&(Bt=Xt.top-kt.top+k,Vt=Bt-Pt)}function x(V){if(dt)return ne();Ft||(Ft=V),z||ge(),jt=V-Ft,St=Math.min(jt/S,1),St=fe(St),qt(w,Pt+Vt*St,Et+Gt*St),jt<S?window.requestAnimationFrame(x):ne()}function ne(){dt||qt(w,Bt,Yt),Ft=!1,ot.off(w,ht,de),dt&&xt&&xt(ae,v),!dt&&W&&W(v)}function qt(V,I,A){ut&&(V.scrollTop=I),At&&(V.scrollLeft=A),V.tagName.toLowerCase()==="body"&&(ut&&(document.documentElement.scrollTop=I),At&&(document.documentElement.scrollLeft=A))}function bt(V,I){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(r(I)==="object"?A=I:typeof I=="number"&&(A.duration=I),v=ot.$(V),!v)return console.warn("[vue-scrollto warn]: Trying to scroll to an element that is not on the page: "+V);if(w=ot.$(A.container||L.container),S=A.hasOwnProperty("duration")?A.duration:L.duration,z=A.hasOwnProperty("lazy")?A.lazy:L.lazy,B=A.easing||L.easing,k=A.hasOwnProperty("offset")?A.offset:L.offset,pt=A.hasOwnProperty("force")?A.force!==!1:L.force,et=A.hasOwnProperty("cancelable")?A.cancelable!==!1:L.cancelable,q=A.onStart||L.onStart,W=A.onDone||L.onDone,xt=A.onCancel||L.onCancel,At=A.x===void 0?L.x:A.x,ut=A.y===void 0?L.y:A.y,typeof k=="function"&&(k=k(v,w)),Et=Ee(w),Pt=ve(w),ge(),dt=!1,!pt){var Se=w.tagName.toLowerCase()==="body"?document.documentElement.clientHeight||window.innerHeight:w.offsetHeight,re=Pt,$=re+Se,N=Bt-k,Te=N+v.offsetHeight;if(N>=re&&Te<=$){W&&W(v);return}}if(q&&q(v),!Vt&&!Gt){W&&W(v);return}return typeof B=="string"&&(B=Wt[B]||Wt.ease),fe=O.apply(O,B),ot.on(w,ht,de,{passive:!0}),window.requestAnimationFrame(x),function(){ae=null,dt=!0}}return bt},yt=st(),Z=[];function Nt(D){for(var v=0;v<Z.length;++v)if(Z[v].el===D)return Z.splice(v,1),!0;return!1}function It(D){for(var v=0;v<Z.length;++v)if(Z[v].el===D)return Z[v]}function Rt(D){var v=It(D);return v||(Z.push(v={el:D,binding:{}}),v)}function ie(D){var v=Rt(this).binding;if(v.value){if(D.preventDefault(),typeof v.value=="string")return yt(v.value);yt(v.value.el||v.value.element,v.value)}}var U={bind:function(v,w){Rt(v).binding=w,ot.on(v,"click",ie)},unbind:function(v){Nt(v),ot.off(v,"click",ie)},update:function(v,w){Rt(v).binding=w}},Ct={bind:U.bind,unbind:U.unbind,update:U.update,beforeMount:U.bind,unmounted:U.unbind,updated:U.update,scrollTo:yt,bindings:Z},ue=function(v,w){w&&mt(w),v.directive("scroll-to",Ct);var S=v.config.globalProperties||v.prototype;S.$scrollTo=Ct.scrollTo};return typeof window<"u"&&window.Vue&&(window.VueScrollTo=Ct,window.VueScrollTo.setDefaults=mt,window.VueScrollTo.scroller=st,window.Vue.use&&window.Vue.use(ue)),Ct.install=ue,Ct})})(Je);var ji=Je.exports;const qi=_i(ji);const Zi={name:"t-dialog",data(){return{tab:0,isOpen:!1}},props:{title:{type:String,default:""},width:{type:Number,default:800},size:{type:String,default:"standard"},color:{type:String,default:"blue"},persistent:{type:Boolean,default:!1}},methods:{open(){this.isOpen=!0},close(){this.isOpen=!1},toggle(){this.isOpen=!this.isOpen},gotoTab(e){this.tab=e}},watch:{isOpen(e){this.$emit(e?"open":"close")},tab(){this.$emit("tab",this.tab)}},computed:{height(){const e="648px";switch(this.size){case"standard":return e;case"small":return"350px";default:return e}}}};var Ki=function(){var i=this,r=i._self._c;return r("div",{staticClass:"t-dialog"},[r("v-dialog",{attrs:{"max-width":i.width,persistent:i.persistent,scrollable:""},model:{value:i.isOpen,callback:function(h){i.isOpen=h},expression:"isOpen"}},[r("v-card",{ref:"dialog",staticClass:"t-dialog-card",class:["elevation-12",i.size],attrs:{flat:"",height:i.height,xs12:""}},[i._t("overlay"),r("v-toolbar",{staticClass:"t-dialog-toolbar",attrs:{color:i.color,dark:"",tabs:""}},[r("v-toolbar-title",{staticClass:"t-dialog-toolbar-title"},[i._v(" "+i._s(i.title)+" ")]),r("v-spacer"),r("v-tabs",{attrs:{slot:"extension",id:"tabs","background-color":i.color,"slider-color":"white"},slot:"extension",model:{value:i.tab,callback:function(h){i.tab=h},expression:"tab"}},[i._t("tabs")],2)],1),r("v-tabs-items",{model:{value:i.tab,callback:function(h){i.tab=h},expression:"tab"}},[i._t("tab-items")],2),r("v-card-actions",{staticClass:"bottom text-lg-right blue--text",attrs:{bottom:""}},[i._t("buttons")],2)],2)],1)],1)},Ji=[],Qi=ke(Zi,Ki,Ji,!1,null,"27b54e78",null,null);const ta=Qi.exports;var Qe={},ti={exports:{}};/*!
 * Cropper.js v1.5.13
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2022-11-20T05:30:46.114Z
 */(function(e,i){(function(r,h){e.exports=h()})(Ke,function(){function r(o,t){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(o,l).enumerable})),n.push.apply(n,a)}return n}function h(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(a){rt(o,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(n,a))})}return o}function g(o){"@babel/helpers - typeof";return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(o)}function C(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function P(o,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(o,a.key,a)}}function nt(o,t,n){return t&&P(o.prototype,t),n&&P(o,n),Object.defineProperty(o,"prototype",{writable:!1}),o}function rt(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}function gt(o){return Ae(o)||le(o)||he(o)||Ht()}function Ae(o){if(Array.isArray(o))return Ut(o)}function le(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function he(o,t){if(o){if(typeof o=="string")return Ut(o,t);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ut(o,t)}}function Ut(o,t){(t==null||t>o.length)&&(t=o.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=o[n];return a}function Ht(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ot=typeof window<"u"&&typeof window.document<"u",tt=Ot?window:{},Qt=Ot&&tt.document.documentElement?"ontouchstart"in tt.document.documentElement:!1,te=Ot?"PointerEvent"in tt:!1,O="cropper",Wt="all",ee="crop",pe="move",ot="zoom",ht="e",L="w",mt="s",st="n",yt="ne",Z="nw",Nt="se",It="sw",Rt="".concat(O,"-crop"),ie="".concat(O,"-disabled"),U="".concat(O,"-hidden"),Ct="".concat(O,"-hide"),ue="".concat(O,"-invisible"),D="".concat(O,"-modal"),v="".concat(O,"-move"),w="".concat(O,"Action"),S="".concat(O,"Preview"),B="crop",z="move",k="none",pt="crop",et="cropend",q="cropmove",W="cropstart",xt="dblclick",At=Qt?"touchstart":"mousedown",ut=Qt?"touchmove":"mousemove",Et=Qt?"touchend touchcancel":"mouseup",Yt=te?"pointerdown":At,Pt=te?"pointermove":ut,Bt=te?"pointerup pointercancel":Et,Gt="ready",Vt="resize",dt="wheel",kt="zoom",Xt="image/jpeg",ae=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,de=/^data:/,fe=/^data:image\/jpeg;base64,/,Ft=/^img|canvas$/i,jt=200,St=100,ve={viewMode:0,dragMode:B,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:jt,minContainerHeight:St,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Ee='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',ge=Number.isNaN||tt.isNaN;function x(o){return typeof o=="number"&&!ge(o)}var ne=function(t){return t>0&&t<1/0};function qt(o){return typeof o>"u"}function bt(o){return g(o)==="object"&&o!==null}var V=Object.prototype.hasOwnProperty;function I(o){if(!bt(o))return!1;try{var t=o.constructor,n=t.prototype;return t&&n&&V.call(n,"isPrototypeOf")}catch{return!1}}function A(o){return typeof o=="function"}var Se=Array.prototype.slice;function re(o){return Array.from?Array.from(o):Se.call(o)}function $(o,t){return o&&A(t)&&(Array.isArray(o)||x(o.length)?re(o).forEach(function(n,a){t.call(o,n,a,o)}):bt(o)&&Object.keys(o).forEach(function(n){t.call(o,o[n],n,o)})),o}var N=Object.assign||function(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return bt(t)&&a.length>0&&a.forEach(function(s){bt(s)&&Object.keys(s).forEach(function(c){t[c]=s[c]})}),t},Te=/\.\d*(?:0|9){12}\d*$/;function Zt(o){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Te.test(o)?Math.round(o*t)/t:o}var ii=/^width|height|left|top|marginLeft|marginTop$/;function Tt(o,t){var n=o.style;$(t,function(a,l){ii.test(l)&&x(a)&&(a="".concat(a,"px")),n[l]=a})}function ai(o,t){return o.classList?o.classList.contains(t):o.className.indexOf(t)>-1}function X(o,t){if(t){if(x(o.length)){$(o,function(a){X(a,t)});return}if(o.classList){o.classList.add(t);return}var n=o.className.trim();n?n.indexOf(t)<0&&(o.className="".concat(n," ").concat(t)):o.className=t}}function ft(o,t){if(t){if(x(o.length)){$(o,function(n){ft(n,t)});return}if(o.classList){o.classList.remove(t);return}o.className.indexOf(t)>=0&&(o.className=o.className.replace(t,""))}}function Kt(o,t,n){if(t){if(x(o.length)){$(o,function(a){Kt(a,t,n)});return}n?X(o,t):ft(o,t)}}var ni=/([a-z\d])([A-Z])/g;function _e(o){return o.replace(ni,"$1-$2").toLowerCase()}function Me(o,t){return bt(o[t])?o[t]:o.dataset?o.dataset[t]:o.getAttribute("data-".concat(_e(t)))}function oe(o,t,n){bt(n)?o[t]=n:o.dataset?o.dataset[t]=n:o.setAttribute("data-".concat(_e(t)),n)}function ri(o,t){if(bt(o[t]))try{delete o[t]}catch{o[t]=void 0}else if(o.dataset)try{delete o.dataset[t]}catch{o.dataset[t]=void 0}else o.removeAttribute("data-".concat(_e(t)))}var Le=/\s\s*/,ze=function(){var o=!1;if(Ot){var t=!1,n=function(){},a=Object.defineProperty({},"once",{get:function(){return o=!0,t},set:function(s){t=s}});tt.addEventListener("test",n,a),tt.removeEventListener("test",n,a)}return o}();function ct(o,t,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=n;t.trim().split(Le).forEach(function(s){if(!ze){var c=o.listeners;c&&c[s]&&c[s][n]&&(l=c[s][n],delete c[s][n],Object.keys(c[s]).length===0&&delete c[s],Object.keys(c).length===0&&delete o.listeners)}o.removeEventListener(s,l,a)})}function it(o,t,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=n;t.trim().split(Le).forEach(function(s){if(a.once&&!ze){var c=o.listeners,p=c===void 0?{}:c;l=function(){delete p[s][n],o.removeEventListener(s,l,a);for(var f=arguments.length,u=new Array(f),d=0;d<f;d++)u[d]=arguments[d];n.apply(o,u)},p[s]||(p[s]={}),p[s][n]&&o.removeEventListener(s,p[s][n],a),p[s][n]=l,o.listeners=p}o.addEventListener(s,l,a)})}function Jt(o,t,n){var a;return A(Event)&&A(CustomEvent)?a=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(t,!0,!0,n)),o.dispatchEvent(a)}function $e(o){var t=o.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var Oe=tt.location,oi=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Ue(o){var t=o.match(oi);return t!==null&&(t[1]!==Oe.protocol||t[2]!==Oe.hostname||t[3]!==Oe.port)}function He(o){var t="timestamp=".concat(new Date().getTime());return o+(o.indexOf("?")===-1?"?":"&")+t}function se(o){var t=o.rotate,n=o.scaleX,a=o.scaleY,l=o.translateX,s=o.translateY,c=[];x(l)&&l!==0&&c.push("translateX(".concat(l,"px)")),x(s)&&s!==0&&c.push("translateY(".concat(s,"px)")),x(t)&&t!==0&&c.push("rotate(".concat(t,"deg)")),x(n)&&n!==1&&c.push("scaleX(".concat(n,")")),x(a)&&a!==1&&c.push("scaleY(".concat(a,")"));var p=c.length?c.join(" "):"none";return{WebkitTransform:p,msTransform:p,transform:p}}function si(o){var t=h({},o),n=0;return $(o,function(a,l){delete t[l],$(t,function(s){var c=Math.abs(a.startX-s.startX),p=Math.abs(a.startY-s.startY),y=Math.abs(a.endX-s.endX),f=Math.abs(a.endY-s.endY),u=Math.sqrt(c*c+p*p),d=Math.sqrt(y*y+f*f),m=(d-u)/u;Math.abs(m)>Math.abs(n)&&(n=m)})}),n}function me(o,t){var n=o.pageX,a=o.pageY,l={endX:n,endY:a};return t?l:h({startX:n,startY:a},l)}function ci(o){var t=0,n=0,a=0;return $(o,function(l){var s=l.startX,c=l.startY;t+=s,n+=c,a+=1}),t/=a,n/=a,{pageX:t,pageY:n}}function _t(o){var t=o.aspectRatio,n=o.height,a=o.width,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",s=ne(a),c=ne(n);if(s&&c){var p=n*t;l==="contain"&&p>a||l==="cover"&&p<a?n=a/t:a=n*t}else s?n=a/t:c&&(a=n*t);return{width:a,height:n}}function li(o){var t=o.width,n=o.height,a=o.degree;if(a=Math.abs(a)%180,a===90)return{width:n,height:t};var l=a%90*Math.PI/180,s=Math.sin(l),c=Math.cos(l),p=t*c+n*s,y=t*s+n*c;return a>90?{width:y,height:p}:{width:p,height:y}}function hi(o,t,n,a){var l=t.aspectRatio,s=t.naturalWidth,c=t.naturalHeight,p=t.rotate,y=p===void 0?0:p,f=t.scaleX,u=f===void 0?1:f,d=t.scaleY,m=d===void 0?1:d,T=n.aspectRatio,E=n.naturalWidth,R=n.naturalHeight,_=a.fillColor,Y=_===void 0?"transparent":_,F=a.imageSmoothingEnabled,H=F===void 0?!0:F,wt=a.imageSmoothingQuality,J=wt===void 0?"low":wt,b=a.maxWidth,M=b===void 0?1/0:b,G=a.maxHeight,at=G===void 0?1/0:G,Dt=a.minWidth,Lt=Dt===void 0?0:Dt,zt=a.minHeight,Mt=zt===void 0?0:zt,vt=document.createElement("canvas"),K=vt.getContext("2d"),$t=_t({aspectRatio:T,width:M,height:at}),ye=_t({aspectRatio:T,width:Lt,height:Mt},"cover"),Ne=Math.min($t.width,Math.max(ye.width,E)),Ie=Math.min($t.height,Math.max(ye.height,R)),Ge=_t({aspectRatio:l,width:M,height:at}),Ve=_t({aspectRatio:l,width:Lt,height:Mt},"cover"),Xe=Math.min(Ge.width,Math.max(Ve.width,s)),Fe=Math.min(Ge.height,Math.max(Ve.height,c)),Ai=[-Xe/2,-Fe/2,Xe,Fe];return vt.width=Zt(Ne),vt.height=Zt(Ie),K.fillStyle=Y,K.fillRect(0,0,Ne,Ie),K.save(),K.translate(Ne/2,Ie/2),K.rotate(y*Math.PI/180),K.scale(u,m),K.imageSmoothingEnabled=H,K.imageSmoothingQuality=J,K.drawImage.apply(K,[o].concat(gt(Ai.map(function(Ei){return Math.floor(Zt(Ei))})))),K.restore(),vt}var We=String.fromCharCode;function pi(o,t,n){var a="";n+=t;for(var l=t;l<n;l+=1)a+=We(o.getUint8(l));return a}var ui=/^data:.*,/;function di(o){var t=o.replace(ui,""),n=atob(t),a=new ArrayBuffer(n.length),l=new Uint8Array(a);return $(l,function(s,c){l[c]=n.charCodeAt(c)}),a}function fi(o,t){for(var n=[],a=8192,l=new Uint8Array(o);l.length>0;)n.push(We.apply(null,re(l.subarray(0,a)))),l=l.subarray(a);return"data:".concat(t,";base64,").concat(btoa(n.join("")))}function vi(o){var t=new DataView(o),n;try{var a,l,s;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(var c=t.byteLength,p=2;p+1<c;){if(t.getUint8(p)===255&&t.getUint8(p+1)===225){l=p;break}p+=1}if(l){var y=l+4,f=l+10;if(pi(t,y,4)==="Exif"){var u=t.getUint16(f);if(a=u===18761,(a||u===19789)&&t.getUint16(f+2,a)===42){var d=t.getUint32(f+4,a);d>=8&&(s=f+d)}}}if(s){var m=t.getUint16(s,a),T,E;for(E=0;E<m;E+=1)if(T=s+E*12+2,t.getUint16(T,a)===274){T+=8,n=t.getUint16(T,a),t.setUint16(T,1,a);break}}}catch{n=1}return n}function gi(o){var t=0,n=1,a=1;switch(o){case 2:n=-1;break;case 3:t=-180;break;case 4:a=-1;break;case 5:t=90,a=-1;break;case 6:t=90;break;case 7:t=90,n=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:n,scaleY:a}}var mi={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,n=this.options,a=this.container,l=this.cropper,s=Number(n.minContainerWidth),c=Number(n.minContainerHeight);X(l,U),ft(t,U);var p={width:Math.max(a.offsetWidth,s>=0?s:jt),height:Math.max(a.offsetHeight,c>=0?c:St)};this.containerData=p,Tt(l,{width:p.width,height:p.height}),X(t,U),ft(l,U)},initCanvas:function(){var t=this.containerData,n=this.imageData,a=this.options.viewMode,l=Math.abs(n.rotate)%180===90,s=l?n.naturalHeight:n.naturalWidth,c=l?n.naturalWidth:n.naturalHeight,p=s/c,y=t.width,f=t.height;t.height*p>t.width?a===3?y=t.height*p:f=t.width/p:a===3?f=t.width/p:y=t.height*p;var u={aspectRatio:p,naturalWidth:s,naturalHeight:c,width:y,height:f};this.canvasData=u,this.limited=a===1||a===2,this.limitCanvas(!0,!0),u.width=Math.min(Math.max(u.width,u.minWidth),u.maxWidth),u.height=Math.min(Math.max(u.height,u.minHeight),u.maxHeight),u.left=(t.width-u.width)/2,u.top=(t.height-u.height)/2,u.oldLeft=u.left,u.oldTop=u.top,this.initialCanvasData=N({},u)},limitCanvas:function(t,n){var a=this.options,l=this.containerData,s=this.canvasData,c=this.cropBoxData,p=a.viewMode,y=s.aspectRatio,f=this.cropped&&c;if(t){var u=Number(a.minCanvasWidth)||0,d=Number(a.minCanvasHeight)||0;p>1?(u=Math.max(u,l.width),d=Math.max(d,l.height),p===3&&(d*y>u?u=d*y:d=u/y)):p>0&&(u?u=Math.max(u,f?c.width:0):d?d=Math.max(d,f?c.height:0):f&&(u=c.width,d=c.height,d*y>u?u=d*y:d=u/y));var m=_t({aspectRatio:y,width:u,height:d});u=m.width,d=m.height,s.minWidth=u,s.minHeight=d,s.maxWidth=1/0,s.maxHeight=1/0}if(n)if(p>(f?0:1)){var T=l.width-s.width,E=l.height-s.height;s.minLeft=Math.min(0,T),s.minTop=Math.min(0,E),s.maxLeft=Math.max(0,T),s.maxTop=Math.max(0,E),f&&this.limited&&(s.minLeft=Math.min(c.left,c.left+(c.width-s.width)),s.minTop=Math.min(c.top,c.top+(c.height-s.height)),s.maxLeft=c.left,s.maxTop=c.top,p===2&&(s.width>=l.width&&(s.minLeft=Math.min(0,T),s.maxLeft=Math.max(0,T)),s.height>=l.height&&(s.minTop=Math.min(0,E),s.maxTop=Math.max(0,E))))}else s.minLeft=-s.width,s.minTop=-s.height,s.maxLeft=l.width,s.maxTop=l.height},renderCanvas:function(t,n){var a=this.canvasData,l=this.imageData;if(n){var s=li({width:l.naturalWidth*Math.abs(l.scaleX||1),height:l.naturalHeight*Math.abs(l.scaleY||1),degree:l.rotate||0}),c=s.width,p=s.height,y=a.width*(c/a.naturalWidth),f=a.height*(p/a.naturalHeight);a.left-=(y-a.width)/2,a.top-=(f-a.height)/2,a.width=y,a.height=f,a.aspectRatio=c/p,a.naturalWidth=c,a.naturalHeight=p,this.limitCanvas(!0,!1)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,Tt(this.canvas,N({width:a.width,height:a.height},se({translateX:a.left,translateY:a.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var n=this.canvasData,a=this.imageData,l=a.naturalWidth*(n.width/n.naturalWidth),s=a.naturalHeight*(n.height/n.naturalHeight);N(a,{width:l,height:s,left:(n.width-l)/2,top:(n.height-s)/2}),Tt(this.image,N({width:a.width,height:a.height},se(N({translateX:a.left,translateY:a.top},a)))),t&&this.output()},initCropBox:function(){var t=this.options,n=this.canvasData,a=t.aspectRatio||t.initialAspectRatio,l=Number(t.autoCropArea)||.8,s={width:n.width,height:n.height};a&&(n.height*a>n.width?s.height=s.width/a:s.width=s.height*a),this.cropBoxData=s,this.limitCropBox(!0,!0),s.width=Math.min(Math.max(s.width,s.minWidth),s.maxWidth),s.height=Math.min(Math.max(s.height,s.minHeight),s.maxHeight),s.width=Math.max(s.minWidth,s.width*l),s.height=Math.max(s.minHeight,s.height*l),s.left=n.left+(n.width-s.width)/2,s.top=n.top+(n.height-s.height)/2,s.oldLeft=s.left,s.oldTop=s.top,this.initialCropBoxData=N({},s)},limitCropBox:function(t,n){var a=this.options,l=this.containerData,s=this.canvasData,c=this.cropBoxData,p=this.limited,y=a.aspectRatio;if(t){var f=Number(a.minCropBoxWidth)||0,u=Number(a.minCropBoxHeight)||0,d=p?Math.min(l.width,s.width,s.width+s.left,l.width-s.left):l.width,m=p?Math.min(l.height,s.height,s.height+s.top,l.height-s.top):l.height;f=Math.min(f,l.width),u=Math.min(u,l.height),y&&(f&&u?u*y>f?u=f/y:f=u*y:f?u=f/y:u&&(f=u*y),m*y>d?m=d/y:d=m*y),c.minWidth=Math.min(f,d),c.minHeight=Math.min(u,m),c.maxWidth=d,c.maxHeight=m}n&&(p?(c.minLeft=Math.max(0,s.left),c.minTop=Math.max(0,s.top),c.maxLeft=Math.min(l.width,s.left+s.width)-c.width,c.maxTop=Math.min(l.height,s.top+s.height)-c.height):(c.minLeft=0,c.minTop=0,c.maxLeft=l.width-c.width,c.maxTop=l.height-c.height))},renderCropBox:function(){var t=this.options,n=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,t.movable&&t.cropBoxMovable&&oe(this.face,w,a.width>=n.width&&a.height>=n.height?pe:Wt),Tt(this.cropBox,N({width:a.width,height:a.height},se({translateX:a.left,translateY:a.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Jt(this.element,pt,this.getData())}},yi={initPreview:function(){var t=this.element,n=this.crossOrigin,a=this.options.preview,l=n?this.crossOriginUrl:this.url,s=t.alt||"The image to preview",c=document.createElement("img");if(n&&(c.crossOrigin=n),c.src=l,c.alt=s,this.viewBox.appendChild(c),this.viewBoxImage=c,!!a){var p=a;typeof a=="string"?p=t.ownerDocument.querySelectorAll(a):a.querySelector&&(p=[a]),this.previews=p,$(p,function(y){var f=document.createElement("img");oe(y,S,{width:y.offsetWidth,height:y.offsetHeight,html:y.innerHTML}),n&&(f.crossOrigin=n),f.src=l,f.alt=s,f.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',y.innerHTML="",y.appendChild(f)})}},resetPreview:function(){$(this.previews,function(t){var n=Me(t,S);Tt(t,{width:n.width,height:n.height}),t.innerHTML=n.html,ri(t,S)})},preview:function(){var t=this.imageData,n=this.canvasData,a=this.cropBoxData,l=a.width,s=a.height,c=t.width,p=t.height,y=a.left-n.left-t.left,f=a.top-n.top-t.top;!this.cropped||this.disabled||(Tt(this.viewBoxImage,N({width:c,height:p},se(N({translateX:-y,translateY:-f},t)))),$(this.previews,function(u){var d=Me(u,S),m=d.width,T=d.height,E=m,R=T,_=1;l&&(_=m/l,R=s*_),s&&R>T&&(_=T/s,E=l*_,R=T),Tt(u,{width:E,height:R}),Tt(u.getElementsByTagName("img")[0],N({width:c*_,height:p*_},se(N({translateX:-y*_,translateY:-f*_},t))))}))}},bi={bind:function(){var t=this.element,n=this.options,a=this.cropper;A(n.cropstart)&&it(t,W,n.cropstart),A(n.cropmove)&&it(t,q,n.cropmove),A(n.cropend)&&it(t,et,n.cropend),A(n.crop)&&it(t,pt,n.crop),A(n.zoom)&&it(t,kt,n.zoom),it(a,Yt,this.onCropStart=this.cropStart.bind(this)),n.zoomable&&n.zoomOnWheel&&it(a,dt,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),n.toggleDragModeOnDblclick&&it(a,xt,this.onDblclick=this.dblclick.bind(this)),it(t.ownerDocument,Pt,this.onCropMove=this.cropMove.bind(this)),it(t.ownerDocument,Bt,this.onCropEnd=this.cropEnd.bind(this)),n.responsive&&it(window,Vt,this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,n=this.options,a=this.cropper;A(n.cropstart)&&ct(t,W,n.cropstart),A(n.cropmove)&&ct(t,q,n.cropmove),A(n.cropend)&&ct(t,et,n.cropend),A(n.crop)&&ct(t,pt,n.crop),A(n.zoom)&&ct(t,kt,n.zoom),ct(a,Yt,this.onCropStart),n.zoomable&&n.zoomOnWheel&&ct(a,dt,this.onWheel,{passive:!1,capture:!0}),n.toggleDragModeOnDblclick&&ct(a,xt,this.onDblclick),ct(t.ownerDocument,Pt,this.onCropMove),ct(t.ownerDocument,Bt,this.onCropEnd),n.responsive&&ct(window,Vt,this.onResize)}},wi={resize:function(){if(!this.disabled){var t=this.options,n=this.container,a=this.containerData,l=n.offsetWidth/a.width,s=n.offsetHeight/a.height,c=Math.abs(l-1)>Math.abs(s-1)?l:s;if(c!==1){var p,y;t.restore&&(p=this.getCanvasData(),y=this.getCropBoxData()),this.render(),t.restore&&(this.setCanvasData($(p,function(f,u){p[u]=f*c})),this.setCropBoxData($(y,function(f,u){y[u]=f*c})))}}},dblclick:function(){this.disabled||this.options.dragMode===k||this.setDragMode(ai(this.dragBox,Rt)?z:B)},wheel:function(t){var n=this,a=Number(this.options.wheelZoomRatio)||.1,l=1;this.disabled||(t.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){n.wheeling=!1},50),t.deltaY?l=t.deltaY>0?1:-1:t.wheelDelta?l=-t.wheelDelta/120:t.detail&&(l=t.detail>0?1:-1),this.zoom(-l*a,t)))},cropStart:function(t){var n=t.buttons,a=t.button;if(!(this.disabled||(t.type==="mousedown"||t.type==="pointerdown"&&t.pointerType==="mouse")&&(x(n)&&n!==1||x(a)&&a!==0||t.ctrlKey))){var l=this.options,s=this.pointers,c;t.changedTouches?$(t.changedTouches,function(p){s[p.identifier]=me(p)}):s[t.pointerId||0]=me(t),Object.keys(s).length>1&&l.zoomable&&l.zoomOnTouch?c=ot:c=Me(t.target,w),ae.test(c)&&Jt(this.element,W,{originalEvent:t,action:c})!==!1&&(t.preventDefault(),this.action=c,this.cropping=!1,c===ee&&(this.cropping=!0,X(this.dragBox,D)))}},cropMove:function(t){var n=this.action;if(!(this.disabled||!n)){var a=this.pointers;t.preventDefault(),Jt(this.element,q,{originalEvent:t,action:n})!==!1&&(t.changedTouches?$(t.changedTouches,function(l){N(a[l.identifier]||{},me(l,!0))}):N(a[t.pointerId||0]||{},me(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var n=this.action,a=this.pointers;t.changedTouches?$(t.changedTouches,function(l){delete a[l.identifier]}):delete a[t.pointerId||0],n&&(t.preventDefault(),Object.keys(a).length||(this.action=""),this.cropping&&(this.cropping=!1,Kt(this.dragBox,D,this.cropped&&this.options.modal)),Jt(this.element,et,{originalEvent:t,action:n}))}}},Di={change:function(t){var n=this.options,a=this.canvasData,l=this.containerData,s=this.cropBoxData,c=this.pointers,p=this.action,y=n.aspectRatio,f=s.left,u=s.top,d=s.width,m=s.height,T=f+d,E=u+m,R=0,_=0,Y=l.width,F=l.height,H=!0,wt;!y&&t.shiftKey&&(y=d&&m?d/m:1),this.limited&&(R=s.minLeft,_=s.minTop,Y=R+Math.min(l.width,a.width,a.left+a.width),F=_+Math.min(l.height,a.height,a.top+a.height));var J=c[Object.keys(c)[0]],b={x:J.endX-J.startX,y:J.endY-J.startY},M=function(at){switch(at){case ht:T+b.x>Y&&(b.x=Y-T);break;case L:f+b.x<R&&(b.x=R-f);break;case st:u+b.y<_&&(b.y=_-u);break;case mt:E+b.y>F&&(b.y=F-E);break}};switch(p){case Wt:f+=b.x,u+=b.y;break;case ht:if(b.x>=0&&(T>=Y||y&&(u<=_||E>=F))){H=!1;break}M(ht),d+=b.x,d<0&&(p=L,d=-d,f-=d),y&&(m=d/y,u+=(s.height-m)/2);break;case st:if(b.y<=0&&(u<=_||y&&(f<=R||T>=Y))){H=!1;break}M(st),m-=b.y,u+=b.y,m<0&&(p=mt,m=-m,u-=m),y&&(d=m*y,f+=(s.width-d)/2);break;case L:if(b.x<=0&&(f<=R||y&&(u<=_||E>=F))){H=!1;break}M(L),d-=b.x,f+=b.x,d<0&&(p=ht,d=-d,f-=d),y&&(m=d/y,u+=(s.height-m)/2);break;case mt:if(b.y>=0&&(E>=F||y&&(f<=R||T>=Y))){H=!1;break}M(mt),m+=b.y,m<0&&(p=st,m=-m,u-=m),y&&(d=m*y,f+=(s.width-d)/2);break;case yt:if(y){if(b.y<=0&&(u<=_||T>=Y)){H=!1;break}M(st),m-=b.y,u+=b.y,d=m*y}else M(st),M(ht),b.x>=0?T<Y?d+=b.x:b.y<=0&&u<=_&&(H=!1):d+=b.x,b.y<=0?u>_&&(m-=b.y,u+=b.y):(m-=b.y,u+=b.y);d<0&&m<0?(p=It,m=-m,d=-d,u-=m,f-=d):d<0?(p=Z,d=-d,f-=d):m<0&&(p=Nt,m=-m,u-=m);break;case Z:if(y){if(b.y<=0&&(u<=_||f<=R)){H=!1;break}M(st),m-=b.y,u+=b.y,d=m*y,f+=s.width-d}else M(st),M(L),b.x<=0?f>R?(d-=b.x,f+=b.x):b.y<=0&&u<=_&&(H=!1):(d-=b.x,f+=b.x),b.y<=0?u>_&&(m-=b.y,u+=b.y):(m-=b.y,u+=b.y);d<0&&m<0?(p=Nt,m=-m,d=-d,u-=m,f-=d):d<0?(p=yt,d=-d,f-=d):m<0&&(p=It,m=-m,u-=m);break;case It:if(y){if(b.x<=0&&(f<=R||E>=F)){H=!1;break}M(L),d-=b.x,f+=b.x,m=d/y}else M(mt),M(L),b.x<=0?f>R?(d-=b.x,f+=b.x):b.y>=0&&E>=F&&(H=!1):(d-=b.x,f+=b.x),b.y>=0?E<F&&(m+=b.y):m+=b.y;d<0&&m<0?(p=yt,m=-m,d=-d,u-=m,f-=d):d<0?(p=Nt,d=-d,f-=d):m<0&&(p=Z,m=-m,u-=m);break;case Nt:if(y){if(b.x>=0&&(T>=Y||E>=F)){H=!1;break}M(ht),d+=b.x,m=d/y}else M(mt),M(ht),b.x>=0?T<Y?d+=b.x:b.y>=0&&E>=F&&(H=!1):d+=b.x,b.y>=0?E<F&&(m+=b.y):m+=b.y;d<0&&m<0?(p=Z,m=-m,d=-d,u-=m,f-=d):d<0?(p=It,d=-d,f-=d):m<0&&(p=yt,m=-m,u-=m);break;case pe:this.move(b.x,b.y),H=!1;break;case ot:this.zoom(si(c),t),H=!1;break;case ee:if(!b.x||!b.y){H=!1;break}wt=$e(this.cropper),f=J.startX-wt.left,u=J.startY-wt.top,d=s.minWidth,m=s.minHeight,b.x>0?p=b.y>0?Nt:yt:b.x<0&&(f-=d,p=b.y>0?It:Z),b.y<0&&(u-=m),this.cropped||(ft(this.cropBox,U),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}H&&(s.width=d,s.height=m,s.left=f,s.top=u,this.action=p,this.renderCropBox()),$(c,function(G){G.startX=G.endX,G.startY=G.endY})}},Ci={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&X(this.dragBox,D),ft(this.cropBox,U),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=N({},this.initialImageData),this.canvasData=N({},this.initialCanvasData),this.cropBoxData=N({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(N(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),ft(this.dragBox,D),X(this.cropBox,U)),this},replace:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&t&&(this.isImg&&(this.element.src=t),n?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,$(this.previews,function(a){a.getElementsByTagName("img")[0].src=t}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,ft(this.cropper,ie)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,X(this.cropper,ie)),this},destroy:function(){var t=this.element;return t[O]?(t[O]=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.canvasData,l=a.left,s=a.top;return this.moveTo(qt(t)?t:l+Number(t),qt(n)?n:s+Number(n))},moveTo:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.canvasData,l=!1;return t=Number(t),n=Number(n),this.ready&&!this.disabled&&this.options.movable&&(x(t)&&(a.left=t,l=!0),x(n)&&(a.top=n,l=!0),l&&this.renderCanvas(!0)),this},zoom:function(t,n){var a=this.canvasData;return t=Number(t),t<0?t=1/(1-t):t=1+t,this.zoomTo(a.width*t/a.naturalWidth,null,n)},zoomTo:function(t,n,a){var l=this.options,s=this.canvasData,c=s.width,p=s.height,y=s.naturalWidth,f=s.naturalHeight;if(t=Number(t),t>=0&&this.ready&&!this.disabled&&l.zoomable){var u=y*t,d=f*t;if(Jt(this.element,kt,{ratio:t,oldRatio:c/y,originalEvent:a})===!1)return this;if(a){var m=this.pointers,T=$e(this.cropper),E=m&&Object.keys(m).length?ci(m):{pageX:a.pageX,pageY:a.pageY};s.left-=(u-c)*((E.pageX-T.left-s.left)/c),s.top-=(d-p)*((E.pageY-T.top-s.top)/p)}else I(n)&&x(n.x)&&x(n.y)?(s.left-=(u-c)*((n.x-s.left)/c),s.top-=(d-p)*((n.y-s.top)/p)):(s.left-=(u-c)/2,s.top-=(d-p)/2);s.width=u,s.height=d,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return t=Number(t),x(t)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var n=this.imageData.scaleY;return this.scale(t,x(n)?n:1)},scaleY:function(t){var n=this.imageData.scaleX;return this.scale(x(n)?n:1,t)},scale:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.imageData,l=!1;return t=Number(t),n=Number(n),this.ready&&!this.disabled&&this.options.scalable&&(x(t)&&(a.scaleX=t,l=!0),x(n)&&(a.scaleY=n,l=!0),l&&this.renderCanvas(!0,!0)),this},getData:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.options,a=this.imageData,l=this.canvasData,s=this.cropBoxData,c;if(this.ready&&this.cropped){c={x:s.left-l.left,y:s.top-l.top,width:s.width,height:s.height};var p=a.width/a.naturalWidth;if($(c,function(u,d){c[d]=u/p}),t){var y=Math.round(c.y+c.height),f=Math.round(c.x+c.width);c.x=Math.round(c.x),c.y=Math.round(c.y),c.width=f-c.x,c.height=y-c.y}}else c={x:0,y:0,width:0,height:0};return n.rotatable&&(c.rotate=a.rotate||0),n.scalable&&(c.scaleX=a.scaleX||1,c.scaleY=a.scaleY||1),c},setData:function(t){var n=this.options,a=this.imageData,l=this.canvasData,s={};if(this.ready&&!this.disabled&&I(t)){var c=!1;n.rotatable&&x(t.rotate)&&t.rotate!==a.rotate&&(a.rotate=t.rotate,c=!0),n.scalable&&(x(t.scaleX)&&t.scaleX!==a.scaleX&&(a.scaleX=t.scaleX,c=!0),x(t.scaleY)&&t.scaleY!==a.scaleY&&(a.scaleY=t.scaleY,c=!0)),c&&this.renderCanvas(!0,!0);var p=a.width/a.naturalWidth;x(t.x)&&(s.left=t.x*p+l.left),x(t.y)&&(s.top=t.y*p+l.top),x(t.width)&&(s.width=t.width*p),x(t.height)&&(s.height=t.height*p),this.setCropBoxData(s)}return this},getContainerData:function(){return this.ready?N({},this.containerData):{}},getImageData:function(){return this.sized?N({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,n={};return this.ready&&$(["left","top","width","height","naturalWidth","naturalHeight"],function(a){n[a]=t[a]}),n},setCanvasData:function(t){var n=this.canvasData,a=n.aspectRatio;return this.ready&&!this.disabled&&I(t)&&(x(t.left)&&(n.left=t.left),x(t.top)&&(n.top=t.top),x(t.width)?(n.width=t.width,n.height=t.width/a):x(t.height)&&(n.height=t.height,n.width=t.height*a),this.renderCanvas(!0)),this},getCropBoxData:function(){var t=this.cropBoxData,n;return this.ready&&this.cropped&&(n={left:t.left,top:t.top,width:t.width,height:t.height}),n||{}},setCropBoxData:function(t){var n=this.cropBoxData,a=this.options.aspectRatio,l,s;return this.ready&&this.cropped&&!this.disabled&&I(t)&&(x(t.left)&&(n.left=t.left),x(t.top)&&(n.top=t.top),x(t.width)&&t.width!==n.width&&(l=!0,n.width=t.width),x(t.height)&&t.height!==n.height&&(s=!0,n.height=t.height),a&&(l?n.height=n.width/a:s&&(n.width=n.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var n=this.canvasData,a=hi(this.image,this.imageData,n,t);if(!this.cropped)return a;var l=this.getData(),s=l.x,c=l.y,p=l.width,y=l.height,f=a.width/Math.floor(n.naturalWidth);f!==1&&(s*=f,c*=f,p*=f,y*=f);var u=p/y,d=_t({aspectRatio:u,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),m=_t({aspectRatio:u,width:t.minWidth||0,height:t.minHeight||0},"cover"),T=_t({aspectRatio:u,width:t.width||(f!==1?a.width:p),height:t.height||(f!==1?a.height:y)}),E=T.width,R=T.height;E=Math.min(d.width,Math.max(m.width,E)),R=Math.min(d.height,Math.max(m.height,R));var _=document.createElement("canvas"),Y=_.getContext("2d");_.width=Zt(E),_.height=Zt(R),Y.fillStyle=t.fillColor||"transparent",Y.fillRect(0,0,E,R);var F=t.imageSmoothingEnabled,H=F===void 0?!0:F,wt=t.imageSmoothingQuality;Y.imageSmoothingEnabled=H,wt&&(Y.imageSmoothingQuality=wt);var J=a.width,b=a.height,M=s,G=c,at,Dt,Lt,zt,Mt,vt;M<=-p||M>J?(M=0,at=0,Lt=0,Mt=0):M<=0?(Lt=-M,M=0,at=Math.min(J,p+M),Mt=at):M<=J&&(Lt=0,at=Math.min(p,J-M),Mt=at),at<=0||G<=-y||G>b?(G=0,Dt=0,zt=0,vt=0):G<=0?(zt=-G,G=0,Dt=Math.min(b,y+G),vt=Dt):G<=b&&(zt=0,Dt=Math.min(y,b-G),vt=Dt);var K=[M,G,at,Dt];if(Mt>0&&vt>0){var $t=E/p;K.push(Lt*$t,zt*$t,Mt*$t,vt*$t)}return Y.drawImage.apply(Y,[a].concat(gt(K.map(function(ye){return Math.floor(Zt(ye))})))),_},setAspectRatio:function(t){var n=this.options;return!this.disabled&&!qt(t)&&(n.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var n=this.options,a=this.dragBox,l=this.face;if(this.ready&&!this.disabled){var s=t===B,c=n.movable&&t===z;t=s||c?t:k,n.dragMode=t,oe(a,w,t),Kt(a,Rt,s),Kt(a,v,c),n.cropBoxMovable||(oe(l,w,t),Kt(l,Rt,s),Kt(l,v,c))}return this}},xi=tt.Cropper,Ye=function(){function o(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(C(this,o),!t||!Ft.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=N({},ve,I(n)&&n),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return nt(o,[{key:"init",value:function(){var n=this.element,a=n.tagName.toLowerCase(),l;if(!n[O]){if(n[O]=this,a==="img"){if(this.isImg=!0,l=n.getAttribute("src")||"",this.originalUrl=l,!l)return;l=n.src}else a==="canvas"&&window.HTMLCanvasElement&&(l=n.toDataURL());this.load(l)}}},{key:"load",value:function(n){var a=this;if(n){this.url=n,this.imageData={};var l=this.element,s=this.options;if(!s.rotatable&&!s.scalable&&(s.checkOrientation=!1),!s.checkOrientation||!window.ArrayBuffer){this.clone();return}if(de.test(n)){fe.test(n)?this.read(di(n)):this.clone();return}var c=new XMLHttpRequest,p=this.clone.bind(this);this.reloading=!0,this.xhr=c,c.onabort=p,c.onerror=p,c.ontimeout=p,c.onprogress=function(){c.getResponseHeader("content-type")!==Xt&&c.abort()},c.onload=function(){a.read(c.response)},c.onloadend=function(){a.reloading=!1,a.xhr=null},s.checkCrossOrigin&&Ue(n)&&l.crossOrigin&&(n=He(n)),c.open("GET",n,!0),c.responseType="arraybuffer",c.withCredentials=l.crossOrigin==="use-credentials",c.send()}}},{key:"read",value:function(n){var a=this.options,l=this.imageData,s=vi(n),c=0,p=1,y=1;if(s>1){this.url=fi(n,Xt);var f=gi(s);c=f.rotate,p=f.scaleX,y=f.scaleY}a.rotatable&&(l.rotate=c),a.scalable&&(l.scaleX=p,l.scaleY=y),this.clone()}},{key:"clone",value:function(){var n=this.element,a=this.url,l=n.crossOrigin,s=a;this.options.checkCrossOrigin&&Ue(a)&&(l||(l="anonymous"),s=He(a)),this.crossOrigin=l,this.crossOriginUrl=s;var c=document.createElement("img");l&&(c.crossOrigin=l),c.src=s||a,c.alt=n.alt||"The image to crop",this.image=c,c.onload=this.start.bind(this),c.onerror=this.stop.bind(this),X(c,Ct),n.parentNode.insertBefore(c,n.nextSibling)}},{key:"start",value:function(){var n=this,a=this.image;a.onload=null,a.onerror=null,this.sizing=!0;var l=tt.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(tt.navigator.userAgent),s=function(f,u){N(n.imageData,{naturalWidth:f,naturalHeight:u,aspectRatio:f/u}),n.initialImageData=N({},n.imageData),n.sizing=!1,n.sized=!0,n.build()};if(a.naturalWidth&&!l){s(a.naturalWidth,a.naturalHeight);return}var c=document.createElement("img"),p=document.body||document.documentElement;this.sizingImage=c,c.onload=function(){s(c.width,c.height),l||p.removeChild(c)},c.src=a.src,l||(c.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",p.appendChild(c))}},{key:"stop",value:function(){var n=this.image;n.onload=null,n.onerror=null,n.parentNode.removeChild(n),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var n=this.element,a=this.options,l=this.image,s=n.parentNode,c=document.createElement("div");c.innerHTML=Ee;var p=c.querySelector(".".concat(O,"-container")),y=p.querySelector(".".concat(O,"-canvas")),f=p.querySelector(".".concat(O,"-drag-box")),u=p.querySelector(".".concat(O,"-crop-box")),d=u.querySelector(".".concat(O,"-face"));this.container=s,this.cropper=p,this.canvas=y,this.dragBox=f,this.cropBox=u,this.viewBox=p.querySelector(".".concat(O,"-view-box")),this.face=d,y.appendChild(l),X(n,U),s.insertBefore(p,n.nextSibling),ft(l,Ct),this.initPreview(),this.bind(),a.initialAspectRatio=Math.max(0,a.initialAspectRatio)||NaN,a.aspectRatio=Math.max(0,a.aspectRatio)||NaN,a.viewMode=Math.max(0,Math.min(3,Math.round(a.viewMode)))||0,X(u,U),a.guides||X(u.getElementsByClassName("".concat(O,"-dashed")),U),a.center||X(u.getElementsByClassName("".concat(O,"-center")),U),a.background&&X(p,"".concat(O,"-bg")),a.highlight||X(d,ue),a.cropBoxMovable&&(X(d,v),oe(d,w,Wt)),a.cropBoxResizable||(X(u.getElementsByClassName("".concat(O,"-line")),U),X(u.getElementsByClassName("".concat(O,"-point")),U)),this.render(),this.ready=!0,this.setDragMode(a.dragMode),a.autoCrop&&this.crop(),this.setData(a.data),A(a.ready)&&it(n,Gt,a.ready,{once:!0}),Jt(n,Gt)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var n=this.cropper.parentNode;n&&n.removeChild(this.cropper),ft(this.element,U)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=xi,o}},{key:"setDefaults",value:function(n){N(ve,I(n)&&n)}}]),o}();return N(Ye.prototype,mi,yi,bi,wi,Di,Ci),Ye})})(ti);var ea=ti.exports;Object.defineProperty(Qe,"__esModule",{value:!0});var ia=ea,aa=na(ia);function na(e){return e&&e.__esModule?e:{default:e}}function ra(e,i){var r={};for(var h in e)i.indexOf(h)>=0||Object.prototype.hasOwnProperty.call(e,h)&&(r[h]=e[h]);return r}var oa=typeof window>"u"?[String,Array]:[String,Array,Element,NodeList],sa=Qe.default={render:function(i){var r=this.crossorigin||void 0;return i("div",{style:this.containerStyle},[i("img",{ref:"img",attrs:{src:this.src,alt:this.alt||"image",style:"max-width: 100%",crossorigin:r},on:this.$listeners,style:this.imgStyle})])},props:{containerStyle:Object,src:{type:String,default:""},alt:String,imgStyle:Object,viewMode:Number,dragMode:String,initialAspectRatio:Number,aspectRatio:Number,data:Object,preview:oa,responsive:{type:Boolean,default:!0},restore:{type:Boolean,default:!0},checkCrossOrigin:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},crossorigin:{type:String},modal:{type:Boolean,default:!0},guides:{type:Boolean,default:!0},center:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},background:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!0},autoCropArea:Number,movable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},scalable:{type:Boolean,default:!0},zoomable:{type:Boolean,default:!0},zoomOnTouch:{type:Boolean,default:!0},zoomOnWheel:{type:Boolean,default:!0},wheelZoomRatio:Number,cropBoxMovable:{type:Boolean,default:!0},cropBoxResizable:{type:Boolean,default:!0},toggleDragModeOnDblclick:{type:Boolean,default:!0},minCanvasWidth:Number,minCanvasHeight:Number,minCropBoxWidth:Number,minCropBoxHeight:Number,minContainerWidth:Number,minContainerHeight:Number,ready:Function,cropstart:Function,cropmove:Function,cropend:Function,crop:Function,zoom:Function},mounted:function(){var i=this.$options.props;i.containerStyle,i.src,i.alt,i.imgStyle;var r=ra(i,["containerStyle","src","alt","imgStyle"]),h={};for(var g in r)this[g]!==void 0&&(h[g]=this[g]);this.cropper=new aa.default(this.$refs.img,h)},methods:{reset:function(){return this.cropper.reset()},clear:function(){return this.cropper.clear()},initCrop:function(){return this.cropper.crop()},replace:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.cropper.replace(i,r)},enable:function(){return this.cropper.enable()},disable:function(){return this.cropper.disable()},destroy:function(){return this.cropper.destroy()},move:function(i,r){return this.cropper.move(i,r)},moveTo:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;return this.cropper.moveTo(i,r)},relativeZoom:function(i,r){return this.cropper.zoom(i,r)},zoomTo:function(i,r){return this.cropper.zoomTo(i,r)},rotate:function(i){return this.cropper.rotate(i)},rotateTo:function(i){return this.cropper.rotateTo(i)},scaleX:function(i){return this.cropper.scaleX(i)},scaleY:function(i){return this.cropper.scaleY(i)},scale:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;return this.cropper.scale(i,r)},getData:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.cropper.getData(i)},setData:function(i){return this.cropper.setData(i)},getContainerData:function(){return this.cropper.getContainerData()},getImageData:function(){return this.cropper.getImageData()},getCanvasData:function(){return this.cropper.getCanvasData()},setCanvasData:function(i){return this.cropper.setCanvasData(i)},getCropBoxData:function(){return this.cropper.getCropBoxData()},setCropBoxData:function(i){return this.cropper.setCropBoxData(i)},getCroppedCanvas:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.cropper.getCroppedCanvas(i)},setAspectRatio:function(i){return this.cropper.setAspectRatio(i)},setDragMode:function(i){return this.cropper.setDragMode(i)}}};const ca={name:"image-cropper-dialog",components:{TDialog:ta,VueCropper:sa},data(){return{config:ce,activityIconDialogWidth:800,cropperAspectRatio:0,autoCropArea:1,sourceImageId:"",croppedImageCanvas:null,processing:!1,buttonSpinnerWidth:2,buttonSpinnerSize:18,imageSrc:""}},props:{imageData:{type:[Object,File],default:()=>({})},fileTags:{type:Array,default:()=>[]},fileExtension:{type:String,default:""},serviceType:{type:String,required:!0}},watch:{imageData(e){this.imageSrc=e.url?this.composeFileUrl(e.url,this.serviceType):window.URL.createObjectURL(e)}},computed:{showLoader(){return this.processing&&!this.isGifExtension},isGifExtension(){return this.fileExtension==="gif"}},methods:{composeFileUrl:Vi,saveImage(){this.isGifExtension?this.insertImage():this.insertCroppedImage()},open(){this.clearImages(),this.$refs.dialog.open()},close(){this.$refs.dialog.close(),this.clearImages()},clearImages(){this.sourceImageId="",this.croppedImageCanvas=null},cropImage(){this.croppedImageCanvas=this.$refs.cropper.getCroppedCanvas()},async insertImage(){this.processing=!0;const e=Be({file:this.imageData,tags:this.fileTags}),i=Pe(this.imageData);try{i.url=await Re({data:e,serviceType:this.serviceType})}catch(r){r.response?this.showError("t-file-uploader.upload-failed"):this.showError("common.connection-lost-error")}finally{this.processing=!1}this.$emit("insertCroppedImage",i),this.close()},insertCroppedImage(){this.processing=!0,this.croppedImageCanvas.toBlob(async e=>{const i=new File([e],this.imageData.name,{type:e.type}),r=Be({file:i,tags:this.fileTags}),h=Pe(i);try{h.url=await Re({data:r,serviceType:this.serviceType})}catch(g){g.response?this.showError("t-file-uploader.upload-failed"):this.showError("common.connection-lost-error")}finally{this.processing=!1}this.$emit("insertCroppedImage",h),this.close()})},showError(e){this.$store.dispatch("openSnackBar",{status:"error",text:e})}}};var la=function(){var i=this,r=i._self._c;return r("div",{attrs:{id:"image-cropper-dialog"}},[r("TDialog",{ref:"dialog",attrs:{scrollable:"",size:"standard image-cropper-dialog",title:i.$t("editor.crop-image"),width:i.activityIconDialogWidth}},[r("template",{slot:"tab-items"},[r("div",{staticClass:"data-hj-suppress",attrs:{id:"image-cropper-dialog-container"}},[i.isGifExtension?r("p",{staticClass:"image-cropper-dialog-gif-text"},[i._v(" "+i._s(i.$t("editor.crop-gif"))+" ")]):i._e(),i.imageSrc?r("div",{attrs:{id:"image-cropper-dialog-edit-container"}},[r("div",{attrs:{id:"image-cropper-dialog-image-container"}},[i.isGifExtension?r("img",{attrs:{src:i.imageSrc}}):r("VueCropper",{key:i.imageSrc,ref:"cropper",attrs:{id:"image-cropper-dialog-image","aspect-ratio":i.cropperAspectRatio,"auto-crop-area":i.autoCropArea,cropend:i.cropImage,ready:i.cropImage,src:i.imageSrc}})],1)]):i._e()])]),r("template",{slot:"buttons"},[r("v-spacer"),r("v-btn",{attrs:{id:"image-cropper-dialog-cancel",color:"blue darken-2",text:""},on:{click:i.close}},[i._v(" "+i._s(i.$t("common.cancel"))+" ")]),r("v-btn",{attrs:{id:"image-cropper-dialog-insert",color:"blue darken-2",text:""},on:{click:i.saveImage}},[i.showLoader?r("v-progress-circular",{attrs:{id:"image-cropper-dialog-insert-spinner",indeterminate:"",size:i.buttonSpinnerSize,width:i.buttonSpinnerWidth}}):r("span",[i._v(" "+i._s(i.$t("common.insert"))+" ")])],1)],1)],2)],1)},ha=[],pa=ke(ca,la,ha,!1,null,null,null,null);const ua=pa.exports,da=()=>({activityData:{content:[],savedContent:[],skill:null,id:"",activityId:"",activityRevisionIds:{},language:null,icon:"",title:"",titles:{},description:"",descriptions:"",durationMinutes:0,published:"",version:0,activityType:null},activityId:"",id:"",version:"",tasks:[],componentInstances:{},activePage:{},activeSection:{},activeGroup:{},activeComponent:{}}),fa=(e,i)=>{e.activePage=i},va=(e,i)=>{e.activeSection=i},ga=(e,i)=>{e.activeGroup=i},ma=(e,i)=>{e.activeComponent=i},ya=(e,i)=>{e.activityData=i},ba=(e,i)=>{e.activityData.activityId=i},wa=(e,i)=>{e.activityData.id=i},Da=(e,i)=>{e.activityData.activityRevisionIds=i},Ca=(e,i)=>{e.activityData.content=i},xa=(e,i)=>{e.activityData.description=i},Aa=(e,i)=>{e.activityData.descriptions=i},Ea=(e,i)=>{e.activityData.durationMinutes=i},Sa=(e,i)=>{e.activityData.icon=i},Ta=(e,i)=>{e.activityData.language=i},_a=(e,i)=>{e.activityData.published=i},Ma=(e,i)=>{e.activityData.skill=i},Oa=(e,i)=>{e.activityData.title=i},Na=(e,i)=>{e.activityData.titles=i},Ia=(e,i)=>{e.activityData.version=i},Ra=(e,i)=>{e.activityData.activityType=i},Pa=(e,i)=>{e.activityData.savedContent=i},Ba=(e,i)=>{e.activityData.note=i},ka=(e,{instance:i,componentId:r})=>{Mi.set(e.componentInstances,r,i)},La=(e,i)=>{e.tasks=i},za=(e,{pageIndex:i,data:r})=>{e.activityData.content.splice(i,0,r)},$a=(e,{pageIndex:i,sectionIndex:r,data:h})=>{e.activityData.content[i].sections.splice(r,0,h)},Ua=(e,{pageIndex:i,sectionIndex:r,groupIndex:h,data:g})=>{e.activityData.content[i].sections[r].groups.splice(h,0,g)},Ha=(e,{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g,data:C})=>{e.activityData.content[i].sections[r].groups[h].components.splice(g,0,C)},Wa=(e,{pageIndex:i})=>{e.activityData.content.splice(i,1)},Ya=(e,{pageIndex:i,sectionIndex:r})=>{e.activityData.content[i].sections.splice(r,1)},Ga=(e,{pageIndex:i,sectionIndex:r,groupIndex:h})=>{e.activityData.content[i].sections[r].groups.splice(h,1)},Va=(e,{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g})=>{e.activityData.content[i].sections[r].groups[h].components.splice(g,1)},Xa=Object.freeze(Object.defineProperty({__proto__:null,addActivityContentComponent:Ha,addActivityContentGroup:Ua,addActivityContentPage:za,addActivityContentSection:$a,removeActivityContentComponent:Va,removeActivityContentGroup:Ga,removeActivityContentPage:Wa,removeActivityContentSection:Ya,setActiveComponent:ma,setActiveGroup:ga,setActivePage:fa,setActiveSection:va,setActivityComment:Ba,setActivityContent:Ca,setActivityData:ya,setActivityDescription:xa,setActivityDescriptions:Aa,setActivityDurationMinutes:Ea,setActivityIcon:Sa,setActivityId:ba,setActivityLanguage:Ta,setActivityPublished:_a,setActivityRevisionId:wa,setActivityRevisionIds:Da,setActivitySkill:Ma,setActivityTitle:Oa,setActivityTitles:Na,setActivityType:Ra,setActivityVersion:Ia,setComponentInstance:ka,setSavedContent:Pa,setTasks:La},Symbol.toStringTag,{value:"Module"})),xe=(e,i)=>qi.scrollTo(e,650,{offset:i,container:".dashboard-content",easing:"easeOutCubic"}),Fa=(e,{pageIndex:i})=>{xe(`[pageIndex="${i}"]`,-98)},ja=(e,{pageIndex:i,sectionIndex:r})=>{xe(`[pageIndex="${i}"][sectionIndex="${r}"]`,-98)},qa=(e,{pageIndex:i,sectionIndex:r,groupIndex:h})=>{xe(`[pageIndex="${i}"][sectionIndex="${r}"][groupIndex="${h}"]`,-128)},Za=(e,{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g})=>{xe(`[pageIndex="${i}"][sectionIndex="${r}"][groupIndex="${h}"][componentIndex="${g}"]`,-162)},Ka=({state:e})=>{const i=window.open("/viewer","_blank");i.PREVIEW_DATA=we(e.activityData)},Ja=({state:e},i)=>{const r=i+"/activity/metadata?activity_id="+e.activityData.activityId;window.open(r,"_blank")},Qa=async({commit:e},i)=>{const r=await zi(i);if(r)return e("setActivityData",r),e("setActivityId",r.activityId),e("setActivityRevisionId",r.id),e("setActivityRevisionIds",r.activityRevisionIds),e("setActivityContent",r.content),e("setActivityDescription",r.description),e("setActivityDescriptions",r.descriptions),e("setActivityDurationMinutes",r.durationMinutes),e("setActivityIcon",r.icon),e("setActivityLanguage",r.language),e("setActivityPublished",r.published),e("setActivitySkill",r.skill),e("setActivityTitle",r.title),e("setActivityTitles",r.titles),e("setActivityVersion",r.version),e("setActivityComment",r.note),e("setActivityType",r.type),r},tn=({commit:e},i)=>{e("setActivityTitle",i)},en=({commit:e},i)=>{e("setActivityIcon",i)},an=({commit:e},i)=>{e("setActivityLanguage",i)},nn=({commit:e},i)=>{e("setActivityDescription",i)},rn=({commit:e},i)=>{const r=JSON.parse(JSON.stringify(i.content));e("setSavedContent",r)},on=async({commit:e},i)=>{await Hi(i),e("setActivityPublished",!0)},sn=async({commit:e},i)=>{try{const r=await Ui(i);e("setActivityRevisionId",r.id),e("setActivityVersion",r.version)}catch(r){console.error(r)}},cn=async({commit:e,getters:i})=>{const r=await $i(i.activityData);return e("setActivityRevisionId",r.id),e("setActivityVersion",r.version),r},ln=({commit:e},{instance:i,componentId:r})=>{e("setComponentInstance",{instance:i,componentId:r})},hn=({state:e,dispatch:i})=>{for(const r in e.componentInstances){const h=e.componentInstances[r];if(!h.validate())return i("scrollToComponent",h.$parent),i("activateComponent",h.$parent),h.__showValidationMessage(),!1}return!0},pn=async({commit:e})=>{const i=await Wi();e("setTasks",i)},un=({commit:e,state:i},{pageIndex:r,data:h}={})=>(r||(r=De(i.activityData.content)),e("setActivePage",{pageIndex:r}),h||(h={id:Q(),title:"",sections:[]}),e("addActivityContentPage",{pageIndex:r,data:h}),{pageIndex:r}),dn=({commit:e,state:i},{pageIndex:r,sectionIndex:h,data:g}={})=>(h||(h=De(i.activityData.content[r].sections)),g||(g={id:Q(),groups:[]}),e("setActivePage",{pageIndex:r}),e("setActiveSection",{pageIndex:r,sectionIndex:h}),e("addActivityContentSection",{pageIndex:r,sectionIndex:h,data:g}),{pageIndex:r,sectionIndex:h}),fn=({commit:e,state:i},{pageIndex:r,sectionIndex:h,groupIndex:g,size:C,data:P}={})=>{const nt=i.activityData.content[r].sections[h].groups;return g||(g=De(nt)),P||(P={id:Q(),size:C,components:[]}),e("setActivePage",{pageIndex:r}),e("setActiveSection",{pageIndex:r,sectionIndex:h}),e("setActiveGroup",{groupIndex:g,sectionIndex:h,pageIndex:r}),e("addActivityContentGroup",{pageIndex:r,sectionIndex:h,groupIndex:g,data:P}),{pageIndex:r,sectionIndex:h,groupIndex:g}},vn=({commit:e,state:i},{pageIndex:r,sectionIndex:h,groupIndex:g,componentIndex:C,type:P,content:nt,data:rt}={})=>{const gt=i.activityData.content[r].sections[h].groups[g].components;return C=Number.isInteger(C)?C+1:De(gt),rt||(rt={id:Q(),type:P,content:nt||{},secrets:{}}),e("setActivePage",{pageIndex:r}),e("setActiveSection",{pageIndex:r,sectionIndex:h}),e("setActiveGroup",{groupIndex:g,sectionIndex:h,pageIndex:r}),e("setActiveComponent",{componentIndex:C,groupIndex:g,sectionIndex:h,pageIndex:r}),e("addActivityContentComponent",{pageIndex:r,sectionIndex:h,groupIndex:g,componentIndex:C,data:rt}),{pageIndex:r,sectionIndex:h,groupIndex:g,componentIndex:C}},gn=({state:e},{pageIndex:i,title:r,sections:h})=>{r!==void 0&&(e.activityData.content[i].title=r),h!==void 0&&(e.activityData.content[i].sections=h)},mn=({state:e},{pageIndex:i,sectionIndex:r,groups:h})=>{h!==void 0&&(e.activityData.content[i].sections[r].groups=h)},yn=({state:e},{pageIndex:i,sectionIndex:r,groupIndex:h,components:g})=>{g!==void 0&&(e.activityData.content[i].sections[r].groups[h].components=g)},bn=({state:e},{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g,content:C})=>{C!==void 0&&(e.activityData.content[i].sections[r].groups[h].components[g].content=C)},wn=({dispatch:e,commit:i},{pageIndex:r})=>{e("deactivatePage"),i("removeActivityContentPage",{pageIndex:r})},Dn=({commit:e},{pageIndex:i,sectionIndex:r})=>{e("setActiveSection",{}),e("setActiveGroup",{}),e("setActiveComponent",{}),e("removeActivityContentSection",{pageIndex:i,sectionIndex:r})},Cn=({dispatch:e,commit:i},{pageIndex:r,sectionIndex:h,groupIndex:g})=>{e("deactivateGroup"),i("removeActivityContentGroup",{pageIndex:r,sectionIndex:h,groupIndex:g})},xn=({dispatch:e,commit:i},{pageIndex:r,sectionIndex:h,groupIndex:g,componentIndex:C})=>{e("deactivateComponent"),i("removeActivityContentComponent",{pageIndex:r,sectionIndex:h,groupIndex:g,componentIndex:C})},An=({dispatch:e,state:i},{pageIndex:r})=>{const h=i.activityData.content[r],g=we(h);g.id=Q();for(const C in g.sections){g.sections[C].id=Q();for(const P in g.sections[C].groups){g.sections[C].groups[P].id=Q();for(const nt in g.sections[C].groups[P].components)g.sections[C].groups[P].components[nt].id=Q()}}e("addPage",{pageIndex:r+1,data:g})},En=({dispatch:e,state:i},{pageIndex:r,sectionIndex:h})=>{const g=we(i.activityData.content[r].sections[h]);g.id=Q();for(const C in g.groups){g.groups[C].id=Q();for(const P in g.groups[C].components)g.groups[C].components[P].id=Q()}e("addSection",{pageIndex:r,sectionIndex:h+1,data:g})},Sn=({dispatch:e,state:i},{pageIndex:r,sectionIndex:h,groupIndex:g})=>{const C=i.activityData.content[r].sections[h].groups[g],P=we(C);P.id=Q();for(const nt in P.components)P.components[nt].id=Q();e("addGroup",{pageIndex:r,sectionIndex:h,groupIndex:g+1,data:P})},Tn=({state:e},{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g})=>{const C=e.activityData.content[i].sections[r].groups[h].components[g];navigator.clipboard.writeText(JSON.stringify(C))},_n=(e,i,r)=>e.splice(r,0,e.splice(i,1)[0]),Mn=(e,i,r)=>e.splice(r,0,e.splice(i,1)[0]),On=(e,i,r,h)=>i.splice(h,0,i.splice(r,1)[0]),Nn=({state:e},{pageIndex:i})=>{const r=e.activityData.content;return r.splice(i-1,0,r.splice(i,1)[0])},In=({state:e},{pageIndex:i})=>{const r=e.activityData.content;return r.splice(i-1,0,r.splice(i,1)[0])},Rn=({state:e},{pageIndex:i,sectionIndex:r})=>{const h=e.activityData.content[i].sections;return h.splice(r-1,0,h.splice(r,1)[0])},Pn=({state:e},{pageIndex:i,sectionIndex:r})=>{const h=e.activityData.content[i].sections;return h.splice(r+1,0,h.splice(r,1)[0])},Bn=({state:e},{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g})=>{const C=e.activityData.content[i].sections[r].groups[h].components;return C.splice(g-1,0,C.splice(g,1)[0])},kn=({state:e},{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g})=>{const C=e.activityData.content[i].sections[r].groups[h].components;return C.splice(g+1,0,C.splice(g,1)[0])},Ln=({commit:e},{pageIndex:i})=>{i&&e("setActivePage",{pageIndex:i})},zn=({commit:e},{pageIndex:i,sectionIndex:r})=>{0<=i&&0<=r&&(e("setActivePage",{pageIndex:i}),e("setActiveSection",{pageIndex:i,sectionIndex:r}))},$n=({commit:e},{pageIndex:i,sectionIndex:r,groupIndex:h})=>{0<=i&&0<=r&&0<=h&&(e("setActivePage",{pageIndex:i}),e("setActiveSection",{pageIndex:i,sectionIndex:r}),e("setActiveGroup",{pageIndex:i,sectionIndex:r,groupIndex:h}))},Un=({commit:e},{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g})=>{0<=i&&0<=r&&0<=h&&0<=g&&(e("setActivePage",{pageIndex:i}),e("setActiveSection",{pageIndex:i,sectionIndex:r}),e("setActiveGroup",{pageIndex:i,sectionIndex:r,groupIndex:h}),e("setActiveComponent",{pageIndex:i,sectionIndex:r,groupIndex:h,componentIndex:g}))},Hn=({commit:e,dispatch:i})=>{e("setActivePage",{}),i("deactivateSection")},Wn=({commit:e,dispatch:i})=>{e("setActiveSection",{}),i("deactivateGroup")},Yn=({commit:e,dispatch:i})=>{e("setActiveGroup",{}),i("deactivateComponent")},Gn=({commit:e})=>{e("setActiveComponent",{})},Vn=({state:e},i)=>e.activityData.content[i],Xn=({state:e},i,r)=>e.activityData.content[i].sections[r],Fn=({state:e})=>e.activityData.content[e.activeGroup.pageIndex].sections[e.activeGroup.sectionIndex].groups[e.activeGroup.groupIndex],jn=({state:e},i,r,h,g)=>e.activityData.content[i].sections[r].groups[h].components[g],qn=({commit:e,dispatch:i})=>{e("showLoadingSpinner");try{const r=new URL(location.href).pathname.split("/").pop();i("getActivityRevision",r)}catch(r){console.error(r)}},Zn=Object.freeze(Object.defineProperty({__proto__:null,Startup:qn,activateComponent:Un,activateGroup:$n,activatePage:Ln,activateSection:zn,addComponent:vn,addGroup:fn,addPage:un,addSection:dn,changeComponent:bn,changeGroup:yn,changePage:gn,changeSection:mn,checkValidation:hn,copyComponent:Tn,deactivateComponent:Gn,deactivateGroup:Yn,deactivatePage:Hn,deactivateSection:Wn,deleteComponent:xn,deleteGroup:Cn,deletePage:wn,deleteSection:Dn,duplicateGroup:Sn,duplicatePage:An,duplicateSection:En,getActivityRevision:Qa,getComponent:jn,getGroup:Fn,getPage:Vn,getSection:Xn,linkTo360:Ja,loadTaskList:pn,moveComponent:On,moveComponentDown:kn,moveComponentUp:Bn,movePage:_n,movePageDown:In,movePageUp:Nn,moveSection:Mn,moveSectionDown:Pn,moveSectionUp:Rn,previewActivity:Ka,publishActivity:on,registerComponent:ln,saveActivityRevision:sn,scrollToComponent:Za,scrollToGroup:qa,scrollToPage:Fa,scrollToSection:ja,setActivityDescription:nn,setActivityIcon:en,setActivityLanguage:an,setActivitySavedContent:rn,setActivityTitle:tn,updateActivity:cn},Symbol.toStringTag,{value:"Module"})),Kn=e=>({pageIndex:i})=>e.activePage.pageIndex===i,Jn=e=>0<Object.keys(e.activeGroup).length&&ei(e.activeGroup),Qn=e=>({pageIndex:i,sectionIndex:r})=>e.activePage.pageIndex===i&&e.activeSection.sectionIndex===r,ei=e=>(i,r,h)=>e.activePage.pageIndex===i&&e.activeSection.sectionIndex===r&&e.activeGroup.groupIndex===h,tr=e=>(i,r,h,g)=>e.activePage.pageIndex===i&&e.activeSection.sectionIndex===r&&e.activeGroup.groupIndex===h&&e.activeComponent.componentIndex===g,er=e=>e.activityData.content.filter(i=>0<i.sections.filter(r=>0<r.groups.filter(h=>0<h.components.filter(g=>g.content.__EXAMINABLE&&(!g.content.autoExamine||g.content.autoExamine===!1)).length).length).length).length===0,ir=(e,i)=>({activityId:e.activityData.activityId,language:e.activityData.language,limit:e.options.itemsPerPage,offset:i.offset,sort:i.sort}),ar=e=>e.options.page!==1?e.options.itemsPerPage*(e.options.page-1):0,nr=e=>e.options.sortDesc[0]?"-"+e.options.sortBy[0]:e.options.sortBy[0],rr=e=>({id:e.activityData.activityId,title:e.activityData.titles,icon:e.activityData.icon,description:e.activityData.descriptions,durationMinutes:e.activityData.durationMinutes}),or=Object.freeze(Object.defineProperty({__proto__:null,activityData:rr,activityMetaPayload:ir,isAutoExamine:er,isComponentActive:tr,isGroupActive:ei,isPageActive:Kn,isSectionActive:Qn,isThereAnActiveGroup:Jn,offset:ar,sort:nr},Symbol.toStringTag,{value:"Module"})),xr=()=>({state:da(),mutations:Xa,actions:Zn,getters:or}),sr="editor";const cr={name:"t-file-uploader",components:{ImageCropperDilaog:ua},data(){return{processing:!1,fileOwner:"",activityId:"",revisionId:"",imageData:{},fileTags:[],fileExtension:""}},props:{files:{type:Array,default:()=>[]},extensions:{type:Array,default:()=>ce.allSupportedExtensions},multipleFiles:{type:Boolean,default:!0},maximumSize:{type:Number,default:1/0},prompt:{type:String,default:""},noUpload:{type:Boolean,default:!1},serviceType:{type:String,required:!0}},computed:{...Oi({activity:e=>e[sr].activityData}),acceptedExtensions(){return this.extensions.map(e=>`.${e}`).join(",")}},methods:{...Ni(["activityIcon"]),insertCroppedImage(e){this.files.push(e)},getFileTags(){return location.href.includes(qe)?[{key:"Source",value:"Activity"},{key:"Id",value:this.activity.activityId},{key:"RevisionId",value:this.activity.id},{key:"Attachment",value:"Submission"}]:location.href.includes(Ii)?[{key:"Source",value:"Activity"},{key:"Id",value:this.$store.state.viewer.activityId},{key:"Attachment",value:"Submission"},{key:"Skill",value:this.$store.state.viewer.skill}]:[]},openImageCropperDilaog(){this.$refs.imageCropperDilaog.open()},async fileUpload(e,i,r,h){try{if(!this.noUpload){if(Xi(e.name)&&1>=i.length&&location.href.includes(qe)){this.imageData=r,this.openImageCropperDilaog(),this.processing=!1;return}e.url=await Re({data:h,serviceType:this.serviceType,owner:this.fileOwner})}this.files.push(e)}catch(g){this.processing=!1;const C=g.response?"t-file-uploader.upload-failed":"common.connection-lost-error";return this.showError(C),g}},async uploadFiles(){const e=this.$refs.fileInput.files;this.processing=!0,this.fileTags=await this.getFileTags();let i=!0;for(const r of e){const h=Be({file:r,tags:this.fileTags}),g=Pe(r);if(Fi(g.size)>this.maximumSize){this.showError("t-file-uploader.file-size"),this.processing=!1,i=!1;continue}if(this.fileExtension=Ce(g.name).toLowerCase(),!this.extensions.includes(this.fileExtension)){this.showError("t-file-uploader.file-type"),this.processing=!1,i=!1;continue}i=!await this.fileUpload(g,e,r,h)}this.processing=!1,this.$refs.fileInput&&(this.$refs.fileInput.value=null),this.$emit("uploaded",i)},showError(e){this.$store.dispatch("openSnackBar",{status:"error",text:e})}},watch:{processing(e){this.$emit("update:uploading",e)}}};var lr=function(){var i=this,r=i._self._c;return r("div",{staticClass:"t-file-uploader"},[r("div",{staticClass:"t-file-uploader-upload-box"},[i.processing?r("div",{staticClass:"t-file-uploader-loading-spinner"},[r("div",{staticClass:"t-file-uploader-progress-bar"},[r("v-progress-circular",{attrs:{color:"primary",indeterminate:""}})],1),r("div",{staticClass:"t-file-uploader-waiting-text"},[i._v(" "+i._s(i.$t("common.file-loading"))+" ")])]):r("div",{staticClass:"t-file-uploader-upload-text"},[r("v-btn",{attrs:{icon:""}},[r("v-icon",{attrs:{color:"#757575"}},[i._v(" cloud_upload ")])],1),r("p",[i._v(i._s(i.prompt))])],1),r("input",{ref:"fileInput",staticClass:"t-file-uploader-input",attrs:{accept:i.acceptedExtensions,multiple:i.multipleFiles,name:"files",processing:i.processing,title:"",type:"file"},on:{input:i.uploadFiles}})]),r("ImageCropperDilaog",{ref:"imageCropperDilaog",attrs:{fileExtension:i.fileExtension,fileTags:i.fileTags,imageData:i.imageData,serviceType:i.serviceType},on:{insertCroppedImage:i.insertCroppedImage}})],1)},hr=[],pr=ke(cr,lr,hr,!1,null,null,null,null);const Ar=pr.exports;export{Wi as G,ua as I,gr as S,ta as T,qi as V,sa as _,Pe as a,Ar as b,Vi as c,mr as d,Q as e,Be as f,Cr as g,xr as h,br as i,vr as j,Ui as k,zi as l,sr as m,wr as n,Dr as o,Xi as p,yr as q};